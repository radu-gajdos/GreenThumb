import React, { useEffect, useState } from "react"
import {
  Bot,
  LifeBuoy,
  Map,
  Send,
  SidebarIcon,
  Users,
  Calendar,
  LayoutDashboard,
  Notebook,
  BarChart
} from "lucide-react"
import { useTranslation } from "react-i18next"
import { NavProjects } from "@/components/layout/nav-projects"
import { NavSecondary } from "@/components/layout/nav-secondary"
import { NavUser } from "@/components/layout/nav-user"
import {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarHeader,
  SidebarMenu,
  SidebarMenuButton,
  SidebarMenuItem,
  useSidebar
} from "@/components/ui/sidebar"
import { Button } from "../ui/button"
import { useAuth } from "@/hooks/useAuth"

export function AppSidebar({ ...props }: React.ComponentProps<typeof Sidebar>) {
  const { toggleSidebar } = useSidebar()
  const { user } = useAuth()
  const { t } = useTranslation()
  const [userData, setUserData] = useState<Object>({})

  const data = {
    navSecondary: [
      {
        title: t("appSidebar.help"),
        url: "#",
        icon: LifeBuoy
      }
    ],
    projects: [
      {
        name: t("appSidebar.dashboard"),
        url: "dashboard",
        icon: LayoutDashboard
      },
      {
        name: t("appSidebar.calendar"),
        url: "calendar",
        icon: Calendar
      },
      {
        name: t("appSidebar.plots"),
        url: "plots",
        icon: Map
      },
      {
        name: t("appSidebar.aiChat"),
        url: "ai-chat",
        icon: Bot
      },
      {
        name: t("appSidebar.fieldNotes"),
        url: "field-notes",
        icon: Notebook
      },
      {
        name: t("appSidebar.yieldPredictor"),
        url: "yield",
        icon: BarChart
      },
      {
        name: t("appSidebar.map"),
        url: "map",
        icon: Map
      }
    ]
  }

  useEffect(() => {
    setUserData({
      name: `${user?.name || ""}`,
      email: user?.email,
      avatar: "/avatars/shadcn.jpg"
    })
  }, [user])

  return (
    <Sidebar collapsible="icon" {...props}>
      <SidebarHeader className="border-b border-b-foreground/10 h-16">
        <SidebarMenu>
          <SidebarMenuItem>
            <div className="flex">
              <SidebarMenuButton size="lg" asChild>
                <a href="#">
                  <div className="flex items-center justify-center h-16 w-16 bg-sidebar-primary text-sidebar-primary-foreground">
                    {/* SVG Logo */}
                    <svg width="30" height="44" viewBox="0 0 34 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <mask id="a" maskUnits="userSpaceOnUse" x="0" y=".08" width="34" height="48" fill="#000">
                        <path fill="#fff" d="M0 .08h34v48H0z" />
                        <path d="M26.298 1.188a8.8 8.8 0 0 0-2.77 1.055c-1.707 1.035-2.744 2.165-3.79 4.17-.302.565-.546.988-.546.922a1 1 0 0 0-.067-.272c-.047-.123-.028-.142.067-.085q.126.072.056-.038c-.038-.056-.104-.085-.141-.066-.038.028-.142-.103-.227-.282-.179-.367-.197-.452-.075-.377.047.038.066-.037.028-.15-.047-.18-.056-.18-.103-.047-.047.122-.16.009-.472-.471-.518-.79-1.96-2.231-2.677-2.645-.999-.603-2.035-.98-3.402-1.252-1.292-.264-2.903-.358-3.261-.198-.283.132-.283.668 0 1.76.782 3.04 2.78 5.376 5.523 6.449 1 .386 2.517.753 3.148.753.198 0 .49.028.65.056l.293.057v3.652l-.443-.292c-.754-.47-1.612-.677-2.573-.63-.962.056-1.603.31-2.263.894-.235.207-.48.367-.546.348-.066-.01-.076 0-.029.02.047.027-.056.329-.235.677-.33.668-.396 1.026-.594 3.455-.123 1.365-.368 2.4-.81 3.332-.877 1.836-2.282 3.154-4.063 3.784-.471.17-.858.208-2.583.264-1.857.057-2.055.075-2.356.264-.453.273-.717.574-.896.988-.122.31-.141 1.214-.141 7.06 0 4.33.038 6.835.094 7.06.132.471.519.914.99 1.12.32.151.631.18 2.026.18 1.084 0 1.876.047 2.31.14.82.17 2.055.763 3.346 1.601 1.96 1.271 3.732 2.052 5.655 2.476.622.141 1.414.16 6.457.16h5.75l.612-.292c1.734-.838 2.545-2.664 1.98-4.48-.095-.33-.246-.678-.321-.782-.207-.264-.198-.273.283-.527.603-.301 1.291-1.111 1.564-1.817.33-.866.302-2.062-.056-2.852-.151-.32-.34-.65-.443-.744-.16-.141-.151-.16.217-.452.914-.697 1.348-1.741 1.282-3.06-.048-.922-.283-1.496-.877-2.108l-.349-.358.434-.376c.264-.236.546-.622.735-1.008.292-.583.311-.696.311-1.572 0-.875-.019-.988-.311-1.572-.396-.81-.943-1.346-1.772-1.741l-.679-.32H25.79c-2.44.01-4.533-.01-4.646-.038-.208-.056-.208-.066-.18-1.996.029-2.099-.075-2.946-.509-4.245-.216-.66-.226-.763-.226-3.502v-2.824h.556c.698 0 1.857-.217 2.706-.509 2.347-.8 4.213-2.457 5.391-4.81.735-1.468 1.216-3.342.98-3.86L29.748 1l-1.291.01c-.849 0-1.593.065-2.159.178m1.414 2.09c-.678 2.335-2.564 4.274-4.826 4.97-.754.227-1.875.471-2.224.471-.132 0 .028-.452.424-1.252 1.037-2.07 2.328-3.36 4.081-4.076.783-.32 1.791-.574 2.385-.593l.302-.01zm-15.448.18c1.065.225 2.328.837 3.167 1.524.905.753 2.026 2.316 2.394 3.351l.141.405-.264-.056c-.141-.029-.518-.094-.839-.151-2.705-.461-4.93-2.222-5.862-4.64l-.274-.707.349.047c.188.028.726.132 1.188.226m4.458 11.71c1.084.461 1.942 1.374 2.29 2.476.274.847.35 3.163.18 5.234l-.133 1.496.217.17c.208.17.5.179 5.401.179 5.788 0 5.524-.029 6.146.659.83.922.584 2.41-.519 3.059-.301.179-.537.188-3.732.235-3.393.047-3.422.047-3.63.264-.31.31-.291.885.048 1.214l.255.264 3.383.047 3.375.047.339.264c.528.395.679.743.679 1.59 0 .65-.029.754-.283 1.12-.547.773-.594.782-4.308.839-3.204.047-3.28.047-3.478.254-.301.3-.283.913.047 1.233l.245.254 3.007.047 2.998.047.348.273c1.084.82.867 2.523-.405 3.182l-.5.264H25.96c-1.602 0-2.8.037-2.903.094-.424.226-.434 1.092-.019 1.412.217.17.387.188 2.13.188 1.037 0 2.055.047 2.262.085.905.216 1.518 1.43 1.179 2.334-.18.5-.575.96-.971 1.158-.387.18-.556.189-5.844.189-4.534 0-5.561-.029-6.164-.142-1.65-.339-2.95-.903-4.92-2.165-1.594-1.016-2.253-1.355-3.441-1.741-.905-.302-1.018-.32-2.705-.358l-1.772-.038V27.838l.31-.047c.161-.028 1-.066 1.858-.084 1.725-.047 2.262-.15 3.384-.687.952-.443 1.725-1.017 2.497-1.836 1.688-1.78 2.498-3.794 2.696-6.703a66 66 0 0 1 .15-1.835c.076-.537.538-1.14 1.075-1.403.519-.254 1.442-.282 1.96-.075" />
                      </mask>
                      <path d="M26.298 1.188a8.8 8.8 0 0 0-2.77 1.055c-1.707 1.035-2.744 2.165-3.79 4.17-.302.565-.546.988-.546.922a1 1 0 0 0-.067-.272c-.047-.123-.028-.142.067-.085q.126.072.056-.038c-.038-.056-.104-.085-.141-.066-.038.028-.142-.103-.227-.282-.179-.367-.197-.452-.075-.377.047.038.066-.037.028-.15-.047-.18-.056-.18-.103-.047-.047.122-.16.009-.472-.471-.518-.79-1.96-2.231-2.677-2.645-.999-.603-2.035-.98-3.402-1.252-1.292-.264-2.903-.358-3.261-.198-.283.132-.283.668 0 1.76.782 3.04 2.78 5.376 5.523 6.449 1 .386 2.517.753 3.148.753.198 0 .49.028.65.056l.293.057v3.652l-.443-.292c-.754-.47-1.612-.677-2.573-.63-.962.056-1.603.31-2.263.894-.235.207-.48.367-.546.348-.066-.01-.076 0-.029.02.047.027-.056.329-.235.677-.33.668-.396 1.026-.594 3.455-.123 1.365-.368 2.4-.81 3.332-.877 1.836-2.282 3.154-4.063 3.784-.471.17-.858.208-2.583.264-1.857.057-2.055.075-2.356.264-.453.273-.717.574-.896.988-.122.31-.141 1.214-.141 7.06 0 4.33.038 6.835.094 7.06.132.471.519.914.99 1.12.32.151.631.18 2.026.18 1.084 0 1.876.047 2.31.14.82.17 2.055.763 3.346 1.601 1.96 1.271 3.732 2.052 5.655 2.476.622.141 1.414.16 6.457.16h5.75l.612-.292c1.734-.838 2.545-2.664 1.98-4.48-.095-.33-.246-.678-.321-.782-.207-.264-.198-.273.283-.527.603-.301 1.291-1.111 1.564-1.817.33-.866.302-2.062-.056-2.852-.151-.32-.34-.65-.443-.744-.16-.141-.151-.16.217-.452.914-.697 1.348-1.741 1.282-3.06-.048-.922-.283-1.496-.877-2.108l-.349-.358.434-.376c.264-.236.546-.622.735-1.008.292-.583.311-.696.311-1.572 0-.875-.019-.988-.311-1.572-.396-.81-.943-1.346-1.772-1.741l-.679-.32H25.79c-2.44.01-4.533-.01-4.646-.038-.208-.056-.208-.066-.18-1.996.029-2.099-.075-2.946-.509-4.245-.216-.66-.226-.763-.226-3.502v-2.824h.556c.698 0 1.857-.217 2.706-.509 2.347-.8 4.213-2.457 5.391-4.81.735-1.468 1.216-3.342.98-3.86L29.748 1l-1.291.01c-.849 0-1.593.065-2.159.178m1.414 2.09c-.678 2.335-2.564 4.274-4.826 4.97-.754.227-1.875.471-2.224.471-.132 0 .028-.452.424-1.252 1.037-2.07 2.328-3.36 4.081-4.076.783-.32 1.791-.574 2.385-.593l.302-.01zm-15.448.18c1.065.225 2.328.837 3.167 1.524.905.753 2.026 2.316 2.394 3.351l.141.405-.264-.056c-.141-.029-.518-.094-.839-.151-2.705-.461-4.93-2.222-5.862-4.64l-.274-.707.349.047c.188.028.726.132 1.188.226m4.458 11.71c1.084.461 1.942 1.374 2.29 2.476.274.847.35 3.163.18 5.234l-.133 1.496.217.17c.208.17.5.179 5.401.179 5.788 0 5.524-.029 6.146.659.83.922.584 2.41-.519 3.059-.301.179-.537.188-3.732.235-3.393.047-3.422.047-3.63.264-.31.31-.291.885.048 1.214l.255.264 3.383.047 3.375.047.339.264c.528.395.679.743.679 1.59 0 .65-.029.754-.283 1.12-.547.773-.594.782-4.308.839-3.204.047-3.28.047-3.478.254-.301.3-.283.913.047 1.233l.245.254 3.007.047 2.998.047.348.273c1.084.82.867 2.523-.405 3.182l-.5.264H25.96c-1.602 0-2.8.037-2.903.094-.424.226-.434 1.092-.019 1.412.217.17.387.188 2.13.188 1.037 0 2.055.047 2.262.085.905.216 1.518 1.43 1.179 2.334-.18.5-.575.96-.971 1.158-.387.18-.556.189-5.844.189-4.534 0-5.561-.029-6.164-.142-1.65-.339-2.95-.903-4.92-2.165-1.594-1.016-2.253-1.355-3.441-1.741-.905-.302-1.018-.32-2.705-.358l-1.772-.038V27.838l.31-.047c.161-.028 1-.066 1.858-.084 1.725-.047 2.262-.15 3.384-.687.952-.443 1.725-1.017 2.497-1.836 1.688-1.78 2.498-3.794 2.696-6.703a66 66 0 0 1 .15-1.835c.076-.537.538-1.14 1.075-1.403.519-.254 1.442-.282 1.96-.075" fill="#4F8149" />
                      <path d="M26.298 1.188a8.8 8.8 0 0 0-2.77 1.055c-1.707 1.035-2.744 2.165-3.79 4.17-.302.565-.546.988-.546.922a1 1 0 0 0-.067-.272c-.047-.123-.028-.142.067-.085q.126.072.056-.038c-.038-.056-.104-.085-.141-.066-.038.028-.142-.103-.227-.282-.179-.367-.197-.452-.075-.377.047.038.066-.037.028-.15-.047-.18-.056-.18-.103-.047-.047.122-.16.009-.472-.471-.518-.79-1.96-2.231-2.677-2.645-.999-.603-2.035-.98-3.402-1.252-1.292-.264-2.903-.358-3.261-.198-.283.132-.283.668 0 1.76.782 3.04 2.78 5.376 5.523 6.449 1 .386 2.517.753 3.148.753.198 0 .49.028.65.056l.293.057v3.652l-.443-.292c-.754-.47-1.612-.677-2.573-.63-.962.056-1.603.31-2.263.894-.235.207-.48.367-.546.348-.066-.01-.076 0-.029.02.047.027-.056.329-.235.677-.33.668-.396 1.026-.594 3.455-.123 1.365-.368 2.4-.81 3.332-.877 1.836-2.282 3.154-4.063 3.784-.471.17-.858.208-2.583.264-1.857.057-2.055.075-2.356.264-.453.273-.717.574-.896.988-.122.31-.141 1.214-.141 7.06 0 4.33.038 6.835.094 7.06.132.471.519.914.99 1.12.32.151.631.18 2.026.18 1.084 0 1.876.047 2.31.14.82.17 2.055.763 3.346 1.601 1.96 1.271 3.732 2.052 5.655 2.476.622.141 1.414.16 6.457.16h5.75l.612-.292c1.734-.838 2.545-2.664 1.98-4.48-.095-.33-.246-.678-.321-.782-.207-.264-.198-.273.283-.527.603-.301 1.291-1.111 1.564-1.817.33-.866.302-2.062-.056-2.852-.151-.32-.34-.65-.443-.744-.16-.141-.151-.16.217-.452.914-.697 1.348-1.741 1.282-3.06-.048-.922-.283-1.496-.877-2.108l-.349-.358.434-.376c.264-.236.546-.622.735-1.008.292-.583.311-.696.311-1.572 0-.875-.019-.988-.311-1.572-.396-.81-.943-1.346-1.772-1.741l-.679-.32H25.79c-2.44.01-4.533-.01-4.646-.038-.208-.056-.208-.066-.18-1.996.029-2.099-.075-2.946-.509-4.245-.216-.66-.226-.763-.226-3.502v-2.824h.556c.698 0 1.857-.217 2.706-.509 2.347-.8 4.213-2.457 5.391-4.81.735-1.468 1.216-3.342.98-3.86L29.748 1l-1.291.01c-.849 0-1.593.065-2.159.178Zm1.414 2.09c-.678 2.335-2.564 4.274-4.826 4.97-.754.227-1.875.471-2.224.471-.132 0 .028-.452.424-1.252 1.037-2.07 2.328-3.36 4.081-4.076.783-.32 1.791-.574 2.385-.593l.302-.01zm-15.448.18c1.065.225 2.328.837 3.167 1.524.905.753 2.026 2.316 2.394 3.351l.141.405-.264-.056c-.141-.029-.518-.094-.839-.151-2.705-.461-4.93-2.222-5.862-4.64l-.274-.707.349.047c.188.028.726.132 1.188.226Zm4.458 11.71c1.084.461 1.942 1.374 2.29 2.476.274.847.35 3.163.18 5.234l-.133 1.496.217.17c.208.17.5.179 5.401.179 5.788 0 5.524-.029 6.146.659.83.922.584 2.41-.519 3.059-.301.179-.537.188-3.732.235-3.393.047-3.422.047-3.63.264-.31.31-.291.885.048 1.214l.255.264 3.383.047 3.375.047.339.264c.528.395.679.743.679 1.59 0 .65-.029.754-.283 1.12-.547.773-.594.782-4.308.839-3.204.047-3.28.047-3.478.254-.301.3-.283.913.047 1.233l.245.254 3.007.047 2.998.047.348.273c1.084.82.867 2.523-.405 3.182l-.5.264H25.96c-1.602 0-2.8.037-2.903.094-.424.226-.434 1.092-.019 1.412.217.17.387.188 2.13.188 1.037 0 2.055.047 2.262.085.905.216 1.518 1.43 1.179 2.334-.18.5-.575.96-.971 1.158-.387.18-.556.189-5.844.189-4.534 0-5.561-.029-6.164-.142-1.65-.339-2.95-.903-4.92-2.165-1.594-1.016-2.253-1.355-3.441-1.741-.905-.302-1.018-.32-2.705-.358l-1.772-.038V27.838l.31-.047c.161-.028 1-.066 1.858-.084 1.725-.047 2.262-.15 3.384-.687.952-.443 1.725-1.017 2.497-1.836 1.688-1.78 2.498-3.794 2.696-6.703a66 66 0 0 1 .15-1.835c.076-.537.538-1.14 1.075-1.403.519-.254 1.442-.282 1.96-.075Z" stroke="#4F8149" mask="url(#a)" />
                    </svg>
                  </div>
                  <div className="grid flex-1 text-left text-sm leading-tight ml-1">
                    <span className="truncate font-semibold">Greenthumb</span>
                    <span className="truncate text-xs">{t("appSidebar.brandSubtitle")}</span>
                  </div>
                </a>
              </SidebarMenuButton>
              <div className="flex items-center">
                <Button className="h-8 w-8" variant="ghost" size="icon" onClick={toggleSidebar}>
                  <SidebarIcon />
                </Button>
              </div>
            </div>
          </SidebarMenuItem>
        </SidebarMenu>
      </SidebarHeader>
      <SidebarContent>
        <NavProjects projects={data.projects} />
        <NavSecondary items={data.navSecondary} className="mt-auto" />
      </SidebarContent>
      <SidebarFooter>
        <NavUser user={userData} />
      </SidebarFooter>
    </Sidebar>
  )
}
